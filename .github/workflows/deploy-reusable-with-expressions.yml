name: Deploy Infrastructure With Expressions

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string
    secrets:
      KOMODO_API_URL:
        required: true

env:
  ENVIRONMENT: ${{ inputs.environment }}

jobs:
  validate:
    name: Validate Configuration
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup API helpers
        run: |
          echo "Testing expressions in functions..."
          
          # Function that uses expressions
          test_func() {
            local url="$KOMODO_API_URL"
            echo "URL from env: $url"
          }
          
          test_func
          echo "âœ… Functions with expressions work"
        env:
          KOMODO_API_URL: ${{ secrets.KOMODO_API_URL }}
